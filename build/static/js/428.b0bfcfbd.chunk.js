"use strict";(self.webpackChunkfamily_moments_experience_app=self.webpackChunkfamily_moments_experience_app||[]).push([[428],{14112:function(e,n,t){t.d(n,{$0:function(){return u},Lg:function(){return a},XF:function(){return c},eG:function(){return h},gn:function(){return r},mH:function(){return l}});var r="iOS"===function(){var e=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(e)?"Windows Phone":/android/i.test(e)?"Android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"iOS":"Desktop"}(),i=new Date,s=("0"+i.getDate()).slice(-2),o=("0"+(i.getMonth()+1)).slice(-2),a=i.getFullYear()+"-"+o+"-"+s,u=(i.getHours()<10?"0"+i.getHours():i.getHours())+":"+(i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes())+":"+i.getSeconds();function c(e){return 9999999,Math.floor(9999999*Math.random())}function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return n.setMinutes(n.getMinutes()+e),n}var p=0,f=navigator.userAgent.toLowerCase().indexOf("android")>-1;function d(e){!0!==e&&p++,!f&&p>=2||f&&p>=1?window.history.back():window.history.pushState({},"")}function h(){d(!0),window.addEventListener("popstate",d)}},27275:function(e,n,t){t.d(n,{Jl:function(){return c},RQ:function(){return g},U6:function(){return d},nW:function(){return v},oe:function(){return p},wm:function(){return w}});var r=t(28683),i=t(15861),s=t(87757),o=t.n(s),a=t(79328),u=t(48317);function c(e){return l.apply(this,arguments)}function l(){return(l=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting session..."),e.next=3,(0,u.Pd)(a.R+"/session/user/"+n).then((function(e){return e}));case 3:return t=e.sent,e.abrupt("return",(0,r.Z)({},t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting user..."),e.next=3,(0,u.Pd)(a.R+"/user/"+n).then((function(e){return e}));case 3:return t=e.sent,e.abrupt("return",(0,r.Z)({},t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting role..."),e.next=3,(0,u.Pd)(a.R+"/role/"+n).then((function(e){return e}));case 3:return t=e.sent,e.abrupt("return",(0,r.Z)({},t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,n,t,r,i,s){return m.apply(this,arguments)}function m(){return(m=(0,i.Z)(o().mark((function e(n,t,r,i,s,c){var l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting user answers..."),e.next=3,(0,u.Pd)(a.R+"/questions/user/answered/"+n+"/"+t+"/"+r+"/"+i+"/"+s+"/"+c).then((function(e){return e}));case 3:return l=e.sent,e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,n){return x.apply(this,arguments)}function x(){return(x=(0,i.Z)(o().mark((function e(n,t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting other users status..."),e.next=3,(0,u.Pd)(a.R+"/session/users/"+n+"/"+t).then((function(e){return e}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,n,t,r,i){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)(o().mark((function e(n,t,r,i,s){var c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting other users answered..."),e.next=3,(0,u.Pd)(a.R+"/questions/answered/"+n+"/"+t+"/"+r+"/"+i+"/"+s).then((function(e){return e}));case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},34709:function(e,n,t){t.d(n,{$6:function(){return v},JC:function(){return b},JV:function(){return p},jr:function(){return g},o_:function(){return w}});var r=t(70885),i=t(15861),s=t(87757),o=t.n(s),a=t(78402),u=t(79328),c=t(14112),l=t(48317);function p(e,n,t,r,i,s,o){return f.apply(this,arguments)}function f(){return(f=(0,i.Z)(o().mark((function e(n,t,r,i,s,a,c){var p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p={code:n,headings:t,subtitle:r,campaign:i,datetime:s,topic:a,click_url:c},e.next=3,(0,l.QZ)(u.R+"/web-push",p).then((function(e){console.log("Sending Web Push... => ",e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,n,t,r){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)(o().mark((function e(n,t,r,i){var s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={phone:n,message:t,datetime:r||null,click_url:i},e.next=3,(0,l.QZ)(u.R+"/sms-push",s).then((function(e){console.log("Sending SMS Push... => ",e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,n,t){return m.apply(this,arguments)}function m(){return(m=(0,i.Z)(o().mark((function e(n,t,r){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({app_id:"".concat("569117be-390c-4e5b-b865-f7522b09dcf2"),external_user_id:r,tags:{session_id:t}})},fetch("https://onesignal.com/api/v1/players/"+n,i).then((function(e){return e.json()})).then((function(e){return console.log("Updating player id... => ",e.success)})).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return x.apply(this,arguments)}function x(){return(x=(0,i.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.next=3,(0,l.Pd)(u.R+"/devices").then((function(e){n=e.body.players}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,n,t){return y.apply(this,arguments)}function y(){return(y=(0,i.Z)(o().mark((function e(n,t,r){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.QZ)(u.R+"/device",{phone:n,code:t,session_id:r}).then((function(e){return e}));case 2:return i=e.sent,e.abrupt("return",{response:i});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,n){var t="Knock Knock!",i="Default Campaign",s="Default Topic",o=new Date,l=u.x.concat("/"),f="Questions are now available!",h="Have you completed your task? If not do it now!",g=new Date(c.Lg);g.setDate(g.getDate()+1);g.setDate(g.getDate()),c.gn?d(n,"Welcome to Family Moments Experience!",null,u.x):p(e,t,"Welcome to Family Moments Experience!",i,o,s,u.x);(new Date).toLocaleTimeString("en-US",{hour12:!1});for(var m=0;m<7;m++){var w=g.toISOString().split("T"),x=(0,r.Z)(w,1)[0],v=(0,c.mH)(10,new Date(x+"T"+a.Xd.phaseA_time)),y=(0,c.mH)(10,new Date(x+"T"+a.Xd.phaseB_time)),b=(0,c.mH)(10,new Date(x+"T"+a.Xd.phaseC_time));c.gn?(d(n,f,new Date(x+"T"+a.Xd.phaseA_time),l),d(n,h,v,l),d(n,f,new Date(x+"T"+a.Xd.phaseB_time),l),d(n,h,y,l),d(n,f,new Date(x+"T"+a.Xd.phaseC_time),l),d(n,h,b,l)):(p(e,t,f,i,new Date(x+"T"+a.Xd.phaseA_time),s,l),p(e,t,h,i,v,s,l),p(e,t,f,i,new Date(x+"T"+a.Xd.phaseB_time),s,l),p(e,t,h,i,y,s,l),p(e,t,f,i,new Date(x+"T"+a.Xd.phaseC_time),s,l),p(e,t,h,i,b,s,l)),g.setDate(g.getDate()+1)}}},93428:function(e,n,t){t.r(n),t.d(n,{default:function(){return P}});var r=t(15861),i=t(70885),s=t(87757),o=t.n(s),a=t(72791),u=t(77813),c=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"],l=t(24846),p=t(48317),f=t(79328),d=t(86155),h=t(62130),g=t(34709),m=t(21830),w=t.n(m),x=t(27275),v=t(16871),y=t(56834),b=t(14112),j=t(78048),Z=t(80184),S=function(e){switch(e){case"Joined":return"success-gradient";case"Inactive":default:return"secondary-gradient";case"Pending":return"warning-gradient";case"Banned":return"danger-gradient"}},P=function(){var e=(0,v.s0)(),n=(0,a.useState)(!1),t=(0,i.Z)(n,2),s=t[0],m=t[1],P=(0,a.useState)(!1),k=(0,i.Z)(P,2),D=k[0],_=k[1],C=(0,a.useState)("Join"),M=(0,i.Z)(C,2),T=M[0],R=M[1],A=(0,a.useState)(!1),N=(0,i.Z)(A,2),W=N[0],B=N[1],F="",H="",J=(0,a.useState)(""),X=(0,i.Z)(J,2),E=X[0],U=X[1],L=(0,a.useState)(""),O=(0,i.Z)(L,2),G=O[0],I=O[1],Q=(0,a.useState)(""),V=(0,i.Z)(Q,2),K=V[0],Y=V[1],$=(0,a.useState)([]),q=(0,i.Z)($,2),z=q[0],ee=q[1];(0,a.useEffect)((function(){(0,h.MD)(),(0,h.ej)("session_id")||ne()}),[]);var ne=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w().fire({title:"Welcome",text:"to Family Moments Experience",imageUrl:"logo-2.png",imageWidth:80,imageAlt:"Family Moments Experience",showConfirmButton:!0,confirmButtonText:"Proceed",confirmButtonColor:"#198754",allowOutsideClick:!1}).then((function(e){e.isConfirmed&&n()})),n=function(){var e=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w().mixin({confirmButtonText:"Next",confirmButtonColor:"#198754",allowOutsideClick:!1}),e.next=3,n.fire({title:"What's your code?",input:"text",inputPlaceholder:"Enter your code...",currentProgressStep:0,inputValidator:function(e){if(!e)return"You need to write something!";F=e,U(e),(0,x.oe)(F).then((function(e){(0,h.d8)("code",F,180),(0,x.U6)(e.RoleId).then((function(e){(0,h.d8)("role",e.title,180),(0,x.Jl)(F).then((function(e){H=e.id||"",Y(e.id||""),(0,h.d8)("is_admin",9e3===H,180),""===H?n.fire({title:"Session not found please try again!",currentProgressStep:1}).then((function(e){e.isConfirmed&&ne()})):H&&(b.gn?n.fire({title:"What's your phone number?",input:"text",inputPlaceholder:"99123456",currentProgressStep:1,inputValidator:function(e){if(!e)return"You need to write something!";"+357"+e,I("+357"+e),(0,g.$6)("+357"+e,F,H).then((function(e){""!==e.response?((0,d.b)(e.response.message,"success"),m(!0),console.log(e)):n.fire({title:"Oops. Something went wrong. Please try again!",currentProgressStep:1}).then((function(e){e.isConfirmed&&ne()}))}))}}):n.fire({title:"Please subscribe to the push notification service before joining the session...",currentProgressStep:1}).then((function(e){e.isConfirmed&&y.Z.showNativePrompt().then((function(){Promise.resolve(y.Z.isPushNotificationsEnabled()).then((function(e){console.log("Checking push notifications status... => ",e),e?m(!0):(0,d.b)("Push Notifications must be enabled!","info")})).catch((function(){(0,d.b)("Push Notifications must be enabled!","info")}))}))})))}))}))}))}});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=(0,r.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),(0,h.d8)("session_id",K,180),_(!0),(0,p.U3)(f.R+"/session/update/"+K+"/"+E,{activated:!0}).then((function(){R("Waiting for others to join..."),B(!0),b.gn||y.Z.getUserId((function(e){(0,g.jr)(e,K,E).then((function(){re()}))})),b.gn&&re()})).catch((function(e){alert(e)}));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function re(){var n=new Date,t=n.getTime()+6048e5;t=new Date(t);var r=setInterval((function(){(0,x.wm)(K,E).then((function(i){ee(i),(0,p.Pd)(f.R+"/session/count/"+(0,h.ej)("session_id")).then((function(i){i&&0===i.count&&((0,p.U3)(f.R+"/sessions/update/"+(0,h.ej)("session_id"),{start_date:new Date(n),end_date:t,status:"Active"}),(0,h.d8)("status","Active",180),_(!1),(0,d.V)("Session established!","success"),(0,g.JC)(E,G),_(!1),e("/"),clearInterval(r))}))}))}),5e3)}return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)("div",{className:"bg-light min-vh-100 d-flex flex-row align-items-center",children:(0,Z.jsx)(u.KB,{children:(0,Z.jsx)(u.rb,{className:"justify-content-center",children:(0,Z.jsx)(u.b7,{md:8,lg:8,children:(0,Z.jsxs)(u.dL,{children:[(0,Z.jsx)(u.rb,{style:{verticalAlign:"baseline"},children:(0,Z.jsx)(u.xH,{className:"landing-card-lg",style:{writingMode:"vertical-rl",background:"#a0bcc2"},children:(0,Z.jsx)(u.sl,{className:"text-center",children:(0,Z.jsx)(u.DW,{src:"logo.png",style:{width:"100%",height:"150px",objectFit:"cover"}})})})}),(0,Z.jsx)(u.xH,{className:"p-6 bg-white text-black",children:(0,Z.jsxs)(u.sl,{children:[(0,Z.jsx)(u.DW,{rounded:!0,src:"logo-2.png",className:"landing-card",style:{width:"30%",objectFit:"cover"}}),(0,Z.jsx)("br",{className:"landing-card"}),(0,Z.jsxs)(u.lx,{onSubmit:function(e){_(!0),te(e)},children:[(0,Z.jsx)("h4",{children:"Welcome to Family Moments Experience"}),(0,Z.jsx)("br",{}),z.map((function(e,n){return(0,Z.jsxs)("div",{children:[e.code,": ",(0,Z.jsx)(u.C_,{color:S(e.activated?"Joined":"Pending"),children:e.activated?"Joined":"Pending"})]},n)})),(0,Z.jsx)("br",{}),(0,Z.jsxs)(u.rb,{children:[(0,Z.jsx)(u.b7,{style:{display:s?"none":"block"},children:(0,Z.jsx)(j.Q,{})}),(0,Z.jsx)(u.b7,{style:{textAlign:"end",margin:"20px 0 0 0",display:s?"block":"none"},children:(0,Z.jsxs)(u.Nd,{color:"success",spinnerType:"grow",loading:D,variant:"outline",disabled:W,type:"submit",children:[(0,Z.jsx)(l.Z,{icon:c})," ",T]})})]})]})]})})]})})})})})})}}}]);
//# sourceMappingURL=428.b0bfcfbd.chunk.js.map